# instructions from https://docs.hsr.io/hsrc_user_manual_en/howto/pc_install.html
 
# ... (removed b/c includes non-public info)
sudo apt-get update
sudo apt-get install ros-noetic-tmc-desktop-full

# Uninstall 
$ sudo apt-get purge ros-noetic-hsr* ros-noetic-tmc-*
$ sudo rm /etc/apt/sources.list.d/tmc.list*
$ sudo apt-get update
$ sudo apt-key del tmc.key


# Test that gazebo is working:
roslaunch gazebo_ros empty_world.launch


# Update `ros_configs/`:
cp /opt/ros/noetic/share/hsrb_gazebo_launch/launch/hsrb_butler_bot_world.launch ros_configs/
cp /opt/ros/noetic/share/hsrb_gazebo_launch/launch/include/hsrb_gazebo_common.xml ros_configs/
cp /opt/ros/noetic/share/tmc_gazebo_worlds/worlds/butler_bot_world.world ros_configs/




# Rviz
rostopic echo /clicked_point # then 'Publish Point' in Rviz




# -----------
# Test grasping

ihsrb

def reset():
    omni_base.go_abs(0,0,0)
    whole_body.move_to_neutral()
    collision_world.remove_all()

reset()

collision_world.add_box(x=0.5, y=0.75, z=.7, pose=geometry.pose(x=1.0, y=0.0, z=0.35), frame_id='map') # desk height is .7
whole_body.collision_world = collision_world


q = geometry.quaternion(x=0.7071068, y=0, z=0.7071068, w=0)
target_pose=geometry.Pose(pos=geometry.vector3(x=1.0, y=0.0, z=0.8), ori=q)
whole_body.move_end_effector_pose(pose=target_pose, ref_frame_id="map")


# old
target_pose=geometry.Pose(pos=geometry.vector3(x=0.5, y=0.0, z=0.8), ori=q)
whole_body.move_end_effector_pose(pose=pose, ref_frame_id="map")


# -----------
# Development

# 1. Start gazebo
# roslaunch hsrb_gazebo_launch hsrb_megaweb2015_world.launch
# roslaunch hsrb_gazebo_launch hsrb_apartment_world.launch
roslaunch hsrb_gazebo_launch hsrb_butler_bot_world.launch
# Then press play on gazebo


# 2. Run python 
cdbb
python3 main.py


sim_mode
ihsrb

